<!DOCTYPE html>

<html>
  <head>
    <title>Corsair</title>
    <link rel="stylesheet" type="text/css" href="game.css">
  </head>

  
  <body>
    <h1> Corsair. Conquering the seas.</h1>
    <p>Stuff</p>

  <script src="http://cloud.github.com/downloads/uxebu/bonsai/bonsai-0.4.0.min.js"></script>

  <div id=content>

  <div id=player></div>
  <script type="bs" id="bs">

  var sea = new Rect(0, 0, 1000, 1000).fill("blue").addTo(stage);

  function Ship(x, y){
    this.width = 40;
    this.height = 20;
    
 //   this.x = x;
   // this.y = y;

    this.speed = 1;
    this.angle = 0;

    this.shape = new Rect(0, 0, this.width, this.height);
	var origin = new Point(this.width/2, this.height/2);
	this.shape.setOrigin(origin);
    this.shape.fill("white");
    this.shape.attr({
	  origin: new Point(this.width/2, this.height/2),
      x: x - this.width/2,
      y: y - this.height/2,
      rotation: this.angle
    });




  //  this.shape.attr({
//  	origin: { x: this.width/2, y: this.height/2}
 
	//});

    this.setLocation(x, y);
    this.shape.addTo(stage);
  };

  Ship.prototype.move = function(){
    player.updateAngle(mouse_x, mouse_y);
    this.speed = Math.sqrt(Math.pow(this.x - mouse_x,2) + Math.pow(this.y -
          mouse_y,2)) / 100;
    this.setLocation(this.x + Math.cos(this.angle) * this.speed,
                this.y + Math.sin(this.angle) * this.speed);
  };

  Ship.prototype.updateAngle = function(mouse_x, mouse_y){
    this.angle = Math.atan2(mouse_y - this.y, mouse_x - this.x);
  //  th//is.shape.attr.rotation = this.angle;
    this.shape.attr({
      rotation: this.angle
    });
  };

  Ship.prototype.setLocation = function(x, y){
    this.x = x;
    this.y = y; 


    this.shape.attr({
      x: x - this.width/2,
      y: y - this.height/2,
    //  rotation: this.angle
    });
  };

  var player = new Ship(50, 60);

  var mouse_x = 0;
  var mouse_y = 0;

  stage.on('tick', function(e, f) {
    player.move();
  });

  stage.on('pointermove', function(e) {

    mouse_x = e.stageX;
    mouse_y = e.stageY;
  });
  </script>


<script>

  var player = document.getElementById('player');

  var b = bonsai.run(player, {
    code: document.getElementById('bs').innerHTML,
    height: 1000,
    width: 1000,
    framerate: 60
  });

  window.onresize = function() {
    player.style.left = (window.innerWidth - 202)/2 - 350 + 'px';
    player.style.top = window.innerHeight/2 - 200 + 'px';
  };

  window.onresize();

</script>
  </div>


  </div>
  </body>

</html>
